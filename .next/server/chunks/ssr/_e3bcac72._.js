module.exports=[81560,a=>{"use strict";let b=(0,a.i(70106).default)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]);a.s(["Trash2",()=>b],81560)},15618,a=>{"use strict";let b=(0,a.i(70106).default)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);a.s(["Plus",()=>b],15618)},46893,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(97895);let e=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("textarea",{className:(0,d.cn)("flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-base shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:e,...c}));e.displayName="Textarea",a.s(["Textarea",()=>e])},86796,a=>{"use strict";let b=(0,a.i(70106).default)("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]]);a.s(["Upload",()=>b],86796)},96221,a=>{"use strict";let b=(0,a.i(70106).default)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);a.s(["Loader2",()=>b],96221)},77156,a=>{"use strict";let b=(0,a.i(70106).default)("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);a.s(["Eye",()=>b],77156)},5784,a=>{"use strict";let b=(0,a.i(70106).default)("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);a.s(["ChevronDown",()=>b],5784)},28094,a=>{"use strict";var b=a.i(72131),c=a.i(30553),d=a.i(87924),e=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),f=b.forwardRef((a,b)=>(0,d.jsx)(c.Primitive.span,{...a,ref:b,style:{...e,...a.style}}));f.displayName="VisuallyHidden",a.s(["VISUALLY_HIDDEN_STYLES",()=>e,"VisuallyHidden",()=>f])},3130,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(97895);let e=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("div",{ref:e,className:(0,d.cn)("rounded-xl border bg-card text-card-foreground shadow",a),...c}));e.displayName="Card";let f=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("div",{ref:e,className:(0,d.cn)("flex flex-col space-y-1.5 p-6",a),...c}));f.displayName="CardHeader";let g=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("div",{ref:e,className:(0,d.cn)("font-semibold leading-none tracking-tight",a),...c}));g.displayName="CardTitle";let h=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("div",{ref:e,className:(0,d.cn)("text-sm text-muted-foreground",a),...c}));h.displayName="CardDescription";let i=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("div",{ref:e,className:(0,d.cn)("p-6 pt-0",a),...c}));i.displayName="CardContent",c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("div",{ref:e,className:(0,d.cn)("flex items-center p-6 pt-0",a),...c})).displayName="CardFooter",a.s(["Card",()=>e,"CardContent",()=>i,"CardDescription",()=>h,"CardHeader",()=>f,"CardTitle",()=>g])},5522,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(97895);let e=c.forwardRef(({className:a,type:c,...e},f)=>(0,b.jsx)("input",{type:c,className:(0,d.cn)("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:f,...e}));e.displayName="Input",a.s(["Input",()=>e])},17171,a=>{"use strict";var b=a.i(87924),c=a.i(72131);a.i(35112);var d=a.i(11011),e=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((a,e)=>{let f=(0,d.createSlot)(`Primitive.${e}`),g=c.forwardRef((a,c)=>{let{asChild:d,...g}=a;return(0,b.jsx)(d?f:e,{...g,ref:c})});return g.displayName=`Primitive.${e}`,{...a,[e]:g}},{}),f=c.forwardRef((a,c)=>(0,b.jsx)(e.label,{...a,ref:c,onMouseDown:b=>{b.target.closest("button, input, select, textarea")||(a.onMouseDown?.(b),!b.defaultPrevented&&b.detail>1&&b.preventDefault())}}));f.displayName="Label";var g=a.i(187),h=a.i(97895);let i=(0,g.cva)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),j=c.forwardRef(({className:a,...c},d)=>(0,b.jsx)(f,{ref:d,className:(0,h.cn)(i(),a),...c}));j.displayName=f.displayName,a.s(["Label",()=>j],17171)},210,a=>{"use strict";let b=(0,a.i(70106).default)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);a.s(["ArrowLeft",()=>b],210)},11747,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(38246),e=a.i(50944),f=a.i(95245),g=a.i(59501),h=a.i(40695),i=a.i(5522),j=a.i(46893),k=a.i(58213),l=a.i(87682),m=a.i(3130),n=a.i(80281),o=a.i(96221),p=a.i(210),q=a.i(62477),r=a.i(45996),s=a.i(11562),t=a.i(68801);let u=()=>"undefined"!=typeof crypto&&"function"==typeof crypto.randomUUID?crypto.randomUUID():`tmp-${Date.now()}-${Math.random().toString(16).slice(2)}`;function v(){let a=(0,e.useRouter)(),[v,w]=(0,c.useState)(!1),[x,y]=(0,c.useState)([]),[z,A]=(0,c.useState)([]),[B,C]=(0,c.useState)([]),[D]=(0,c.useState)(u),E=(0,f.useForm)({resolver:(0,g.zodResolver)(t.insightFormSchema),defaultValues:{title:"",slug:"",summary:"",type:"blog",authorId:0,tags:[],coverImageUrl:"",isPublished:!1},mode:"onSubmit"});(0,c.useEffect)(()=>{(async()=>{try{let[a,b]=await Promise.all([q.api.get("/admin/authors"),q.api.get("/admin/tags")]);A(a),C(b)}catch(a){console.error("Failed to load data:",a)}})()},[]);let F=async b=>{if(0===x.length)return void alert("Please add at least one content block");if(0===b.authorId)return void alert("Please select an author");let c=[];if(b.title.trim()||c.push("Title is required"),b.slug.trim()||c.push("Slug is required"),b.summary.trim()||c.push("Summary is required"),0===b.authorId&&c.push("Author is required"),0===x.length&&c.push("At least one content block is required"),c.length>0)return void alert(`Please fix the following errors:
${c.join("\n")}`);w(!0);try{let c={title:b.title,slug:b.slug,summary:b.summary,type:b.type,content:x.map(a=>({id:a.id||`${a.type}-${Date.now()}`,type:a.type,data:a.data})),authorId:b.authorId,tags:b.tags||[],coverImageUrl:b.coverImageUrl||void 0,isPublished:b.isPublished??!1,publicId:D};console.log("Submitting data:",JSON.stringify(c,null,2));let d=await q.api.post("/admin/insights",c);console.log("Response:",d),a.push("/admin/insights"),a.refresh()}catch(b){if(console.error("Failed to create insight:",b),console.error("Error details:",b?.data),b?.status===400){let a=b?.data?.errors,c=b?.data?.message,d=Array.isArray(a)?a.map(a=>"string"==typeof a?a:JSON.stringify(a)).join("\n- "):a&&"object"==typeof a?JSON.stringify(a,null,2):"";alert(`Validation error:
${c||""}${d?`
- ${d}`:""}`)}else b?.status===401?(alert("Session expired. Please login again."),a.push("/admin/login")):alert(b?.message||"Failed to create insight")}finally{w(!1)}};return(0,b.jsxs)("div",{className:"container mx-auto py-6 space-y-6",children:[(0,b.jsx)("div",{className:"flex items-center justify-between",children:(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)(d.default,{href:"/admin/insights",children:(0,b.jsxs)(h.Button,{variant:"ghost",size:"sm",children:[(0,b.jsx)(p.ArrowLeft,{className:"h-4 w-4 mr-2"}),"Back to Insights"]})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-3xl font-bold",children:"Create New Insight"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"Add a new insight with block-based content"})]})]})}),(0,b.jsx)(k.Form,{...E,children:(0,b.jsx)("form",{onSubmit:E.handleSubmit(F),className:"space-y-8",children:(0,b.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,b.jsx)("div",{className:"lg:col-span-2 space-y-6",children:(0,b.jsxs)(m.Card,{children:[(0,b.jsxs)(m.CardHeader,{children:[(0,b.jsx)(m.CardTitle,{children:"Content Blocks"}),(0,b.jsx)(m.CardDescription,{children:"Build your insight using different content blocks"})]}),(0,b.jsx)(m.CardContent,{children:(0,b.jsx)(r.default,{blocks:x,onChange:y,publicId:D})})]})}),(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)(m.Card,{children:[(0,b.jsx)(m.CardHeader,{children:(0,b.jsx)(m.CardTitle,{children:"Insight Details"})}),(0,b.jsxs)(m.CardContent,{className:"space-y-4",children:[(0,b.jsx)(k.FormField,{control:E.control,name:"title",render:({field:a})=>(0,b.jsxs)(k.FormItem,{children:[(0,b.jsx)(k.FormLabel,{children:"Title *"}),(0,b.jsx)(k.FormControl,{children:(0,b.jsx)(i.Input,{placeholder:"Enter insight title",...a,onChange:b=>{a.onChange(b);let c=b.target.value;E.setValue("title",c),E.getValues("slug")||E.setValue("slug",c.toLowerCase().replace(/[^a-z0-9\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").trim())}})}),(0,b.jsx)(k.FormMessage,{})]})}),(0,b.jsx)(k.FormField,{control:E.control,name:"slug",render:({field:a})=>(0,b.jsxs)(k.FormItem,{children:[(0,b.jsx)(k.FormLabel,{children:"Slug *"}),(0,b.jsx)(k.FormControl,{children:(0,b.jsx)(i.Input,{placeholder:"insight-slug",...a})}),(0,b.jsx)(k.FormMessage,{})]})}),(0,b.jsx)(k.FormField,{control:E.control,name:"summary",render:({field:a})=>(0,b.jsxs)(k.FormItem,{children:[(0,b.jsx)(k.FormLabel,{children:"Summary *"}),(0,b.jsx)(k.FormControl,{children:(0,b.jsx)(j.Textarea,{placeholder:"Brief summary of the insight",className:"min-h-[100px]",...a})}),(0,b.jsx)(k.FormMessage,{})]})}),(0,b.jsx)(k.FormField,{control:E.control,name:"type",render:({field:a})=>(0,b.jsxs)(k.FormItem,{children:[(0,b.jsx)(k.FormLabel,{children:"Type *"}),(0,b.jsxs)(l.Select,{onValueChange:a.onChange,defaultValue:a.value,children:[(0,b.jsx)(k.FormControl,{children:(0,b.jsx)(l.SelectTrigger,{children:(0,b.jsx)(l.SelectValue,{placeholder:"Select type"})})}),(0,b.jsxs)(l.SelectContent,{children:[(0,b.jsx)(l.SelectItem,{value:"report",children:"Report"}),(0,b.jsx)(l.SelectItem,{value:"publication",children:"Publication"}),(0,b.jsx)(l.SelectItem,{value:"policy-brief",children:"Policy Brief"}),(0,b.jsx)(l.SelectItem,{value:"blog",children:"Blog"})]})]}),(0,b.jsx)(k.FormMessage,{})]})}),(0,b.jsx)(k.FormField,{control:E.control,name:"authorId",render:({field:a})=>(0,b.jsxs)(k.FormItem,{children:[(0,b.jsx)(k.FormLabel,{children:"Author *"}),(0,b.jsxs)(l.Select,{onValueChange:b=>{let c=parseInt(b,10);a.onChange(c)},value:"number"==typeof a.value&&0!==a.value?a.value.toString():"",children:[(0,b.jsx)(k.FormControl,{children:(0,b.jsx)(l.SelectTrigger,{children:(0,b.jsx)(l.SelectValue,{placeholder:"Select author"})})}),(0,b.jsx)(l.SelectContent,{children:0===z.length?(0,b.jsx)(l.SelectItem,{value:"loading",disabled:!0,children:"Loading authors..."}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(l.SelectItem,{value:"select",disabled:!0,children:"Select an author"}),z.map(a=>(0,b.jsx)(l.SelectItem,{value:a.id.toString(),children:a.name},a.id))]})})]}),(0,b.jsx)(k.FormMessage,{})]})}),(0,b.jsx)(k.FormField,{control:E.control,name:"tags",render:({field:a})=>(0,b.jsxs)(k.FormItem,{children:[(0,b.jsx)(k.FormLabel,{children:"Tags"}),(0,b.jsxs)(l.Select,{onValueChange:b=>{let c=parseInt(b,10),d=a.value||[];d.includes(c)||a.onChange([...d,c])},children:[(0,b.jsx)(k.FormControl,{children:(0,b.jsx)(l.SelectTrigger,{children:(0,b.jsx)(l.SelectValue,{placeholder:"Add tags"})})}),(0,b.jsx)(l.SelectContent,{children:B.map(a=>(0,b.jsx)(l.SelectItem,{value:a.id.toString(),children:a.name},a.id))})]}),(0,b.jsx)("div",{className:"flex flex-wrap gap-2 mt-2",children:a.value?.map(c=>{let d=B.find(a=>a.id===c);return d?(0,b.jsxs)("div",{className:"inline-flex items-center gap-1 bg-secondary text-secondary-foreground px-2 py-1 rounded text-sm",children:[d.name,(0,b.jsx)("button",{type:"button",onClick:()=>{a.onChange(a.value?.filter(a=>a!==c))},className:"text-muted-foreground hover:text-foreground",children:"Ã—"})]},d.id):null})}),(0,b.jsx)(k.FormMessage,{})]})}),(0,b.jsx)(k.FormField,{control:E.control,name:"coverImageUrl",render:({field:a})=>(0,b.jsxs)(k.FormItem,{children:[(0,b.jsx)(k.FormLabel,{children:"Cover Image"}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(k.FormControl,{children:(0,b.jsx)(i.Input,{placeholder:"/uploads/insights/uuid/filename.jpg",...a})}),(0,b.jsx)(s.default,{uploadKey:D,onUploadComplete:b=>a.onChange(b),folder:"insights",disabled:v})]}),(0,b.jsx)(k.FormMessage,{})]})}),(0,b.jsx)(k.FormField,{control:E.control,name:"isPublished",render:({field:a})=>(0,b.jsxs)(k.FormItem,{className:"flex items-center justify-between rounded-lg border p-3",children:[(0,b.jsxs)("div",{className:"space-y-0.5",children:[(0,b.jsx)(k.FormLabel,{children:"Publish Immediately"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Make this insight publicly visible"})]}),(0,b.jsx)(k.FormControl,{children:(0,b.jsx)(n.Switch,{checked:a.value,onCheckedChange:a.onChange})})]})})]})]}),(0,b.jsx)(m.Card,{children:(0,b.jsx)(m.CardContent,{className:"pt-6",children:(0,b.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,b.jsxs)(h.Button,{type:"submit",disabled:v,className:"w-full",children:[v&&(0,b.jsx)(o.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}),"Create Insight"]}),(0,b.jsxs)(h.Button,{type:"button",variant:"outline",onClick:async()=>{if(!await E.trigger())return;let a=E.getValues();E.setValue("isPublished",!1);let b={...a,authorId:Number(a.authorId)||0,tags:Array.isArray(a.tags)?a.tags.map(a=>Number(a)).filter(a=>!isNaN(a)):[],isPublished:!1};await F(b)},disabled:v,children:[v&&(0,b.jsx)(o.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}),"Save as Draft"]})]})})})]})]})})})]})}a.s(["default",()=>v])}];

//# sourceMappingURL=_e3bcac72._.js.map