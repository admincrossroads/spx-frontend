module.exports=[81560,a=>{"use strict";let b=(0,a.i(70106).default)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]);a.s(["Trash2",()=>b],81560)},15618,a=>{"use strict";let b=(0,a.i(70106).default)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);a.s(["Plus",()=>b],15618)},46893,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(97895);let e=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("textarea",{className:(0,d.cn)("flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-base shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:e,...c}));e.displayName="Textarea",a.s(["Textarea",()=>e])},86796,a=>{"use strict";let b=(0,a.i(70106).default)("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]]);a.s(["Upload",()=>b],86796)},96221,a=>{"use strict";let b=(0,a.i(70106).default)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);a.s(["Loader2",()=>b],96221)},77156,a=>{"use strict";let b=(0,a.i(70106).default)("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);a.s(["Eye",()=>b],77156)},5784,a=>{"use strict";let b=(0,a.i(70106).default)("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);a.s(["ChevronDown",()=>b],5784)},28094,a=>{"use strict";var b=a.i(72131),c=a.i(30553),d=a.i(87924),e=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),f=b.forwardRef((a,b)=>(0,d.jsx)(c.Primitive.span,{...a,ref:b,style:{...e,...a.style}}));f.displayName="VisuallyHidden",a.s(["VISUALLY_HIDDEN_STYLES",()=>e,"VisuallyHidden",()=>f])},3130,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(97895);let e=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("div",{ref:e,className:(0,d.cn)("rounded-xl border bg-card text-card-foreground shadow",a),...c}));e.displayName="Card";let f=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("div",{ref:e,className:(0,d.cn)("flex flex-col space-y-1.5 p-6",a),...c}));f.displayName="CardHeader";let g=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("div",{ref:e,className:(0,d.cn)("font-semibold leading-none tracking-tight",a),...c}));g.displayName="CardTitle";let h=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("div",{ref:e,className:(0,d.cn)("text-sm text-muted-foreground",a),...c}));h.displayName="CardDescription";let i=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("div",{ref:e,className:(0,d.cn)("p-6 pt-0",a),...c}));i.displayName="CardContent",c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("div",{ref:e,className:(0,d.cn)("flex items-center p-6 pt-0",a),...c})).displayName="CardFooter",a.s(["Card",()=>e,"CardContent",()=>i,"CardDescription",()=>h,"CardHeader",()=>f,"CardTitle",()=>g])},5522,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(97895);let e=c.forwardRef(({className:a,type:c,...e},f)=>(0,b.jsx)("input",{type:c,className:(0,d.cn)("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:f,...e}));e.displayName="Input",a.s(["Input",()=>e])},17171,a=>{"use strict";var b=a.i(87924),c=a.i(72131);a.i(35112);var d=a.i(11011),e=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((a,e)=>{let f=(0,d.createSlot)(`Primitive.${e}`),g=c.forwardRef((a,c)=>{let{asChild:d,...g}=a;return(0,b.jsx)(d?f:e,{...g,ref:c})});return g.displayName=`Primitive.${e}`,{...a,[e]:g}},{}),f=c.forwardRef((a,c)=>(0,b.jsx)(e.label,{...a,ref:c,onMouseDown:b=>{b.target.closest("button, input, select, textarea")||(a.onMouseDown?.(b),!b.defaultPrevented&&b.detail>1&&b.preventDefault())}}));f.displayName="Label";var g=a.i(187),h=a.i(97895);let i=(0,g.cva)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),j=c.forwardRef(({className:a,...c},d)=>(0,b.jsx)(f,{ref:d,className:(0,h.cn)(i(),a),...c}));j.displayName=f.displayName,a.s(["Label",()=>j],17171)},210,a=>{"use strict";let b=(0,a.i(70106).default)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);a.s(["ArrowLeft",()=>b],210)},14548,a=>{"use strict";let b=(0,a.i(70106).default)("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);a.s(["Save",()=>b],14548)},59632,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(95245),f=a.i(59501),g=a.i(40695),h=a.i(5522),i=a.i(46893),j=a.i(58213),k=a.i(87682),l=a.i(3130),m=a.i(80281),n=a.i(96221),o=a.i(210),p=a.i(14548),q=a.i(77156),r=a.i(62477),s=a.i(45996),t=a.i(68801),u=a.i(11562),v=a.i(38246);function w(){let a=(0,d.useRouter)(),w=(0,d.useParams)().publicId,[x,y]=(0,c.useState)(!0),[z,A]=(0,c.useState)(!1),[B,C]=(0,c.useState)([]),[D,E]=(0,c.useState)([]),[F,G]=(0,c.useState)([]),[H,I]=(0,c.useState)(null),J=(0,e.useForm)({resolver:(0,f.zodResolver)(t.insightFormSchema),defaultValues:{title:"",slug:"",summary:"",type:"blog",authorId:0,tags:[],coverImageUrl:"",isPublished:!1}});(0,c.useEffect)(()=>{let b=async()=>{y(!0);try{let[a,b,c]=await Promise.all([r.api.get(`/admin/insights/${w}`),r.api.get("/admin/authors"),r.api.get("/admin/tags")]);I(a),E(b),G(c),J.reset({title:a.title,slug:a.slug,summary:a.summary,type:a.type,authorId:a.author?.id??a.authorId??0,tags:a.tags?.map(a=>a.id)||[],coverImageUrl:a.coverImageUrl||"",isPublished:a.isPublished||!1}),a.content&&Array.isArray(a.content)&&C(a.content)}catch(b){console.error("Failed to load data:",b),a.push("/admin/insights")}finally{y(!1)}};w&&b()},[w,J,a]);let K=async b=>{if(0===B.length)return void alert("Please add at least one content block");A(!0);try{let c={title:b.title,slug:b.slug,summary:b.summary,type:b.type,content:B.map(a=>({id:a.id||`${a.type}-${Date.now()}`,type:a.type,data:a.data})),authorId:b.authorId,tags:b.tags||[],coverImageUrl:b.coverImageUrl||void 0};await r.api.patch(`/admin/insights/${w}`,c);let d=H?.isPublished||!1;b.isPublished&&!d?await r.api.patch(`/admin/insights/${w}/publish`):!b.isPublished&&d&&await r.api.patch(`/admin/insights/${w}`,{isPublished:!1}),a.push("/admin/insights"),a.refresh()}catch(c){console.error("Failed to update insight:",c);let a=c?.data?.message||c?.message||"Failed to update insight",b=c?.data?.errors;if(b&&Array.isArray(b)){let c=b.map(a=>"string"==typeof a?a:JSON.stringify(a)).join("\n- ");alert(`Validation error:
${a}
- ${c}`)}else alert(a)}finally{A(!1)}},L=async()=>{let b=J.getValues("isPublished");A(!0);try{b?(await r.api.patch(`/admin/insights/${w}`,{isPublished:!1}),J.setValue("isPublished",!1),H&&(H.isPublished=!1),alert("Insight unpublished successfully")):(await r.api.patch(`/admin/insights/${w}/publish`),J.setValue("isPublished",!0),H&&(H.isPublished=!0),alert("Insight published successfully")),a.refresh()}catch(a){console.error("Failed to toggle publish:",a),alert(a?.data?.message||a?.message||"Failed to toggle publish status")}finally{A(!1)}};return x?(0,b.jsx)("div",{className:"container mx-auto py-6 flex items-center justify-center min-h-[50vh]",children:(0,b.jsx)(n.Loader2,{className:"h-8 w-8 animate-spin"})}):(0,b.jsxs)("div",{className:"container mx-auto py-6 space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)(v.default,{href:"/admin/insights",children:(0,b.jsxs)(g.Button,{variant:"ghost",size:"sm",children:[(0,b.jsx)(o.ArrowLeft,{className:"h-4 w-4 mr-2"}),"Back to Insights"]})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-3xl font-bold",children:"Edit Insight"}),(0,b.jsxs)("p",{className:"text-muted-foreground",children:["Editing: ",H?.title]})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsxs)(g.Button,{type:"button",variant:H?.isPublished?"outline":"default",onClick:L,disabled:z,children:[(0,b.jsx)(q.Eye,{className:"h-4 w-4 mr-2"}),H?.isPublished?"Unpublish":"Publish Now"]}),(0,b.jsx)(v.default,{href:`/insights/${H?.slug}`,target:"_blank",children:(0,b.jsx)(g.Button,{variant:"outline",size:"sm",children:"View Live"})})]})]}),(0,b.jsx)(j.Form,{...J,children:(0,b.jsx)("form",{onSubmit:J.handleSubmit(K),className:"space-y-8",children:(0,b.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,b.jsx)("div",{className:"lg:col-span-2 space-y-6",children:(0,b.jsxs)(l.Card,{children:[(0,b.jsxs)(l.CardHeader,{children:[(0,b.jsx)(l.CardTitle,{children:"Content Blocks"}),(0,b.jsx)(l.CardDescription,{children:"Edit your insight content blocks"})]}),(0,b.jsx)(l.CardContent,{children:(0,b.jsx)(s.default,{blocks:B,onChange:C,publicId:w})})]})}),(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)(l.Card,{children:[(0,b.jsx)(l.CardHeader,{children:(0,b.jsx)(l.CardTitle,{children:"Insight Details"})}),(0,b.jsxs)(l.CardContent,{className:"space-y-4",children:[(0,b.jsx)(j.FormField,{control:J.control,name:"title",render:({field:a})=>(0,b.jsxs)(j.FormItem,{children:[(0,b.jsx)(j.FormLabel,{children:"Title *"}),(0,b.jsx)(j.FormControl,{children:(0,b.jsx)(h.Input,{placeholder:"Enter insight title",...a,onChange:b=>{let c;a.onChange(b);c=b.target.value,J.setValue("title",c),J.getValues("slug")||J.setValue("slug",c.toLowerCase().replace(/[^a-z0-9\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").trim())}})}),(0,b.jsx)(j.FormMessage,{})]})}),(0,b.jsx)(j.FormField,{control:J.control,name:"slug",render:({field:a})=>(0,b.jsxs)(j.FormItem,{children:[(0,b.jsx)(j.FormLabel,{children:"Slug *"}),(0,b.jsx)(j.FormControl,{children:(0,b.jsx)(h.Input,{placeholder:"insight-slug",...a})}),(0,b.jsx)(j.FormMessage,{})]})}),(0,b.jsx)(j.FormField,{control:J.control,name:"summary",render:({field:a})=>(0,b.jsxs)(j.FormItem,{children:[(0,b.jsx)(j.FormLabel,{children:"Summary *"}),(0,b.jsx)(j.FormControl,{children:(0,b.jsx)(i.Textarea,{placeholder:"Brief summary of the insight",className:"min-h-[100px]",...a})}),(0,b.jsx)(j.FormMessage,{})]})}),(0,b.jsx)(j.FormField,{control:J.control,name:"type",render:({field:a})=>(0,b.jsxs)(j.FormItem,{children:[(0,b.jsx)(j.FormLabel,{children:"Type *"}),(0,b.jsxs)(k.Select,{onValueChange:a.onChange,value:a.value,children:[(0,b.jsx)(j.FormControl,{children:(0,b.jsx)(k.SelectTrigger,{children:(0,b.jsx)(k.SelectValue,{placeholder:"Select type"})})}),(0,b.jsxs)(k.SelectContent,{children:[(0,b.jsx)(k.SelectItem,{value:"report",children:"Report"}),(0,b.jsx)(k.SelectItem,{value:"publication",children:"Publication"}),(0,b.jsx)(k.SelectItem,{value:"policy-brief",children:"Policy Brief"}),(0,b.jsx)(k.SelectItem,{value:"blog",children:"Blog"})]})]}),(0,b.jsx)(j.FormMessage,{})]})}),(0,b.jsx)(j.FormField,{control:J.control,name:"authorId",render:({field:a})=>(0,b.jsxs)(j.FormItem,{children:[(0,b.jsx)(j.FormLabel,{children:"Author *"}),(0,b.jsxs)(k.Select,{onValueChange:b=>a.onChange(parseInt(b)),value:a.value?.toString(),children:[(0,b.jsx)(j.FormControl,{children:(0,b.jsx)(k.SelectTrigger,{children:(0,b.jsx)(k.SelectValue,{placeholder:"Select author"})})}),(0,b.jsx)(k.SelectContent,{children:D.map(a=>(0,b.jsx)(k.SelectItem,{value:a.id.toString(),children:a.name},a.id))})]}),(0,b.jsx)(j.FormMessage,{})]})}),(0,b.jsx)(j.FormField,{control:J.control,name:"tags",render:({field:a})=>(0,b.jsxs)(j.FormItem,{children:[(0,b.jsx)(j.FormLabel,{children:"Tags"}),(0,b.jsxs)(k.Select,{onValueChange:b=>{let c=parseInt(b),d=a.value||[];d.includes(c)||a.onChange([...d,c])},children:[(0,b.jsx)(j.FormControl,{children:(0,b.jsx)(k.SelectTrigger,{children:(0,b.jsx)(k.SelectValue,{placeholder:"Add tags"})})}),(0,b.jsx)(k.SelectContent,{children:F.map(a=>(0,b.jsx)(k.SelectItem,{value:a.id.toString(),children:a.name},a.id))})]}),(0,b.jsx)("div",{className:"flex flex-wrap gap-2 mt-2",children:a.value?.map(c=>{let d=F.find(a=>a.id===c);return d?(0,b.jsxs)("div",{className:"inline-flex items-center gap-1 bg-secondary text-secondary-foreground px-2 py-1 rounded text-sm",children:[d.name,(0,b.jsx)("button",{type:"button",onClick:()=>{a.onChange(a.value?.filter(a=>a!==c))},className:"text-white hover:text-foreground",children:"Ã—"})]},d.id):null})}),(0,b.jsx)(j.FormMessage,{})]})}),(0,b.jsx)(j.FormField,{control:J.control,name:"coverImageUrl",render:({field:a})=>(0,b.jsxs)(j.FormItem,{children:[(0,b.jsx)(j.FormLabel,{children:"Cover Image"}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(j.FormControl,{children:(0,b.jsx)(h.Input,{placeholder:"/uploads/insights/uuid/filename.jpg",...a})}),(0,b.jsx)(u.default,{uploadKey:w,onUploadComplete:b=>a.onChange(b),folder:"insights",disabled:z})]}),(0,b.jsx)(j.FormMessage,{})]})}),(0,b.jsx)(j.FormField,{control:J.control,name:"isPublished",render:({field:a})=>(0,b.jsxs)(j.FormItem,{className:"flex items-center justify-between rounded-lg border p-3",children:[(0,b.jsxs)("div",{className:"space-y-0.5",children:[(0,b.jsx)(j.FormLabel,{children:"Published"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:a.value?"Publicly visible":"Draft (not visible)"})]}),(0,b.jsx)(j.FormControl,{children:(0,b.jsx)(m.Switch,{checked:a.value,onCheckedChange:a.onChange})})]})})]})]}),(0,b.jsx)(l.Card,{children:(0,b.jsx)(l.CardContent,{className:"pt-6",children:(0,b.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,b.jsxs)(g.Button,{type:"submit",disabled:z,className:"w-full",children:[z&&(0,b.jsx)(n.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}),(0,b.jsx)(p.Save,{className:"mr-2 h-4 w-4"}),"Save Changes"]}),(0,b.jsx)(g.Button,{type:"button",variant:"outline",onClick:()=>a.push("/admin/insights"),children:"Cancel"})]})})})]})]})})})]})}a.s(["default",()=>w])}];

//# sourceMappingURL=_f55ffe98._.js.map