{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Victus/Documents/Spiralytix/Website/spiralytix-site/lib/actions/authors.ts"],"sourcesContent":["'use server';\r\n\r\nimport { cookies } from 'next/headers';\r\n\r\nconst API_URL = process.env.NEXT_PUBLIC_API_URL;\r\nconst API_KEY = process.env.NEXT_PUBLIC_API_KEY;\r\n\r\nasync function fetchWithAuth(endpoint: string, options: RequestInit = {}) {\r\n  const cookieStore = await cookies();\r\n  const token = cookieStore.get('token')?.value;\r\n\r\n  if (!token) {\r\n    console.error('No authentication token found');\r\n    throw new Error('No authentication token provided');\r\n  }\r\n\r\n  // Check what API_URL contains\r\n  console.log('API_URL:', API_URL);\r\n  console.log('Endpoint:', endpoint);\r\n  console.log('Full URL:', `${API_URL}${endpoint}`);\r\n  \r\n  const headers = new Headers(options.headers);\r\n  headers.set('x-api-key', API_KEY!);\r\n  headers.set('Cookie', `token=${token}`);\r\n\r\n  if (!(options.body instanceof FormData)) {\r\n    headers.set('Content-Type', 'application/json');\r\n  }\r\n\r\n  try {\r\n    const response = await fetch(`${API_URL}${endpoint}`, {\r\n      ...options,\r\n      headers,\r\n      credentials: 'include',\r\n    });\r\n\r\n    console.log('Response status:', response.status);\r\n    \r\n    if (!response.ok) {\r\n      console.log('Response not OK, checking error...');\r\n      const errorText = await response.text();\r\n      console.log('Error response:', errorText);\r\n      \r\n      let errorData;\r\n      try {\r\n        errorData = JSON.parse(errorText);\r\n      } catch {\r\n        errorData = { message: errorText };\r\n      }\r\n      \r\n      throw new Error(errorData.message || `HTTP ${response.status}`);\r\n    }\r\n\r\n    const data = await response.json();\r\n    console.log('Response data:', data);\r\n    return data;\r\n  } catch (error) {\r\n    console.error('Fetch error:', error);\r\n    throw error;\r\n  }\r\n}\r\n\r\nexport async function getAuthors() {\r\n  try {\r\n    return await fetchWithAuth('/admin/authors', {\r\n      cache: 'no-store',\r\n    });\r\n  } catch (error) {\r\n    console.error('Failed to fetch authors:', error);\r\n    return [];\r\n  }\r\n}\r\n\r\nexport async function getAuthorById(id: number) {\r\n  try {\r\n    console.log('getAuthorById called with ID:', id);\r\n    const author = await fetchWithAuth(`/admin/authors/${id}`, {\r\n      cache: 'no-store',\r\n    });\r\n    console.log('getAuthorById result:', author);\r\n    return author;\r\n  } catch (error) {\r\n    console.error(`Failed to fetch author ${id}:`, error);\r\n    throw error;\r\n  }\r\n}\r\nexport async function createAuthor(data: {\r\n  name: string;\r\n  bio?: string;\r\n  imageUrl?: string;\r\n}) {\r\n  return await fetchWithAuth('/admin/authors', {\r\n    method: 'POST',\r\n    body: JSON.stringify(data),\r\n  });\r\n}\r\n\r\nexport async function updateAuthor(\r\n  id: number,\r\n  data: {\r\n    name?: string;\r\n    bio?: string | null;\r\n    imageUrl?: string | null;\r\n  }\r\n) {\r\n  // Remove empty fields to avoid sending undefined\r\n  const payload: any = {};\r\n  \r\n  if (data.name !== undefined) payload.name = data.name;\r\n  if (data.bio !== undefined) payload.bio = data.bio;\r\n  if (data.imageUrl !== undefined) payload.imageUrl = data.imageUrl;\r\n  \r\n  return await fetchWithAuth(`/admin/authors/${id}`, {\r\n    method: 'PATCH',\r\n    body: JSON.stringify(payload),\r\n  });\r\n}\r\n\r\n\r\nexport async function deleteAuthor(id: number) {\r\n  return await fetchWithAuth(`/admin/authors/${id}`, {\r\n    method: 'DELETE',\r\n  });\r\n}\r\n\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 131, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Victus/Documents/Spiralytix/Website/spiralytix-site/.next-internal/server/app/admin/%28dashboard%29/authors/page/actions.js%20%28server%20actions%20loader%29"],"sourcesContent":["export {deleteAuthor as '407da5c05284833d55406323b7f2fc197acca9e51e'} from 'ACTIONS_MODULE0'\n"],"names":[],"mappings":";AAAA"}}]
}